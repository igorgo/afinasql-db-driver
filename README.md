# afinasql-db-driver
Oracle Database Driver for Afina Sequel
<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [constructor](#constructor)
-   [isOpened](#isopened)
-   [open](#open)
-   [close](#close)
-   [getConnection](#getconnection)
-   [execute](#execute)
-   [SessionInfo](#sessioninfo)
-   [logon](#logon)
-   [logoff](#logoff)

## constructor

Creates An Oracle Database Driver for Afina Sequel

**Parameters**

-   `config` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**
    -   `config.username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
    -   `config.password` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
    -   `config.connectString` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
    -   `config.schema` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**

## isOpened

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**

## open

Opens the database

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;AfinaSqlDbDriver>**

## close

Closes the database

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;AfinaSqlDbDriver>**

## getConnection

Returns a Connection object is obtained by a Pool

**Parameters**

-   `aSessionId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Afina Sequel Session ID

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;oracledb.Connection>**

## execute

Executes a statement

**Parameters**

-   `aSessionId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** An Afina Sequel Session ID
-   `aSql` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** A statement
-   `aBindParams` **(OraSqlParams | [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array))?**  (optional, default `[]`)
-   `aExecuteOptions` **({} | oracledb.IExecuteOptions)?**  (optional, default `{}`)
-   `aConnection` **oracledb.Connection?**  (optional, default `null`)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;oracledb.IExecuteReturn>**

## SessionInfo

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Parameters**

-   `aAfinaUser`
-   `aAfinaWebPassword`
-   `aAfinaCompany`
-   `aAfinaApplication`
-   `aAfinaInterfaceLanguage`
-   `aOldPackageSession`   (optional, default `false`)

**Properties**

-   `NCOMPANY` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)**
-   `SFULLUSERNAME` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
-   `SAPPNAME` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
-   `SCOMPANYFULLNAME` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
-   `sessionID` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**

## logon

Logon to AfinaSql by utilizer

**Parameters**

-   `aAfinaUser` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
-   `aAfinaWebPassword` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**
-   `aAfinaCompany` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?**
-   `aAfinaApplication` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?**
-   `aAfinaInterfaceLanguage` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?**
-   `aOldPackageSession` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** use for "sail" connections (optional, default `false`)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;SessionInfo>**

## logoff

Logs off from AfinaSql

**Parameters**

-   `aSessionId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)**

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>**
